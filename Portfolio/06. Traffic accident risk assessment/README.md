# Оценка риска ДТП

### Использованные инструменты

PostgreSQL, SQLAlchemy, pandas, scikit-learn, LightGBM, seaborn, Matplotlib

### Ключевые особенности

Базы данных, синтез признаков

### Описание задачи

Вы — специалист по Data Science в каршеринговой компании. Вам поступил заказ: нужно создать систему, которая могла бы оценить риск ДТП по выбранному маршруту движения. Под риском понимается вероятность ДТП с любым повреждением транспортного средства. Как только водитель забронировал автомобиль, сел за руль и выбрал маршрут, система должна оценить уровень риска. Если уровень риска высок, водитель увидит предупреждение и рекомендации по маршруту.
Идея создания такой системы находится в стадии предварительного обсуждения и проработки. Чёткого алгоритма работы и подобных решений на рынке ещё не существует. Текущая задача — понять, возможно ли предсказывать ДТП, опираясь на исторические данные одного из регионов.

Идея решения задачи от заказчика: 

1. Создать модель предсказания ДТП (целевое значение — at_fault (виновник) в таблице parties)
     
    1. Для модели выбрать тип виновника — только машина (car).
    2. Выбрать случаи, когда ДТП привело к любым повреждениям транспортного средства, кроме типа SCRATCH (царапина).
    3. Для моделирования ограничиться данными за 2012 год — они самые свежие.
    4. Обязательное условие — учесть фактор возраста автомобиля.
2. На основе модели исследовать основные факторы ДТП.
3. Понять, помогут ли результаты моделирования и анализ важности факторов ответить на вопросы:
     
    1. Возможно ли создать адекватную системы оценки водительского риска при выдаче авто?
    2. Какие ещё факторы нужно учесть?
    3. Нужно ли оборудовать автомобиль какими-либо датчиками или камерой?

Заказчик предлагает вам поработать с базой данных по происшествиям и сформировать свои идеи создания такой системы. 

### Общий вывод

Мы провели статистический анализ, проверили все признаки и в итоге получили датасет из 12 признаков (включая целевой) и почти 46 тысяч записей.

После этого мы обучили несколько моделей и нашли среди них лучшую: LightGBM с F1-score = 0.57937.

Создать адекватную модель, предсказывающую риск ДТП перед выдачей авто возможно, но требуется провести исследование по подбору необходимых признаков.

Качество предсказаний модели далеко от оптимальных 0.8-0.9. Вероятно имея более разнообразные и более сбалансированные исторические данные, мы могли бы предсказывать вероятность ДТП лучше.
